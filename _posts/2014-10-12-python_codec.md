---
layout: post
title: "python转载[编码问题]"
categories: python
tags: [python]
date: 2014-10-12 02:29:52
---

<p>&nbsp;</p>
<p>一 预备知识</p>
<p style="padding-bottom: 10px; line-height: 18px; margin: 0px; padding-left: 0px; padding-right: 0px; font-size: 13px; padding-top: 0px"><strong style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px">字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /></strong>1， 常用字符集分类<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /><span style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; color: #ff0000; padding-top: 0px">ASCII</span>及其扩展字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />作用：表语英语及西欧语言。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />位数：ASCII是用7位表示的，能表示128个字符；其扩展使用8位表示，表示256个字符。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />范围：ASCII从00到7F，扩展从00到FF。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /><span style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; color: #ff0000; padding-top: 0px">ISO-8859-1</span>字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />作用：扩展ASCII，表示西欧、希腊语等。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />位数：8位，<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />范围：从00到FF，兼容ASCII字符集。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /><span style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; color: #ff0000; padding-top: 0px">GB2312</span>字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />作用：国家简体中文字符集，兼容ASCII。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />位数：使用2个字节表示，能表示7445个符号，包括6763个汉字，几乎覆盖所有高频率汉字。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />范围：高字节从A1到F7, 低字节从A1到FE。将高字节和低字节分别加上0XA0即可得到编码。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /><span style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; color: #ff0000; padding-top: 0px">BIG5</span>字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />作用：统一繁体字编码。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />位数：使用2个字节表示，表示13053个汉字。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />范围：高字节从A1到F9，低字节从40到7E，A1到FE。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /><span style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; color: #ff0000; padding-top: 0px">GBK</span>字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />作用：它是GB2312的扩展，加入对繁体字的支持，兼容GB2312。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />位数：使用2个字节表示，可表示21886个字符。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />范围：高字节从81到FE，低字节从40到FE。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /><span style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; color: #ff0000; padding-top: 0px">GB18030</span>字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />作用：它解决了中文、日文、朝鲜语等的编码，兼容GBK。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />位数：它采用变字节表示(1 ASCII，2，4字节)。可表示27484个文字。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />范围：1字节从00到7F; 2字节高字节从81到FE，低字节从40到7E和80到FE；4字节第一三字节从81到FE，第二四字节从30到39。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /><span style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; color: #ff0000; padding-top: 0px">UCS</span>字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />作用：国际标准 ISO 10646 定义了通用字符集 (Universal Character Set)。它是与UNICODE同类的组织，UCS-2和UNICODE兼容。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />位数：它有UCS-2和UCS-4两种格式，分别是2字节和4字节。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />范围：目前，UCS-4只是在UCS-2前面加了0&#215;0000。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /><span style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; color: #ff0000; padding-top: 0px">UNICODE</span>字符集<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />作用：为世界650种语言进行统一编码，兼容ISO-8859-1。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />位数：UNICODE字符集有多个编码方式，分别是UTF-8，UTF-16和UTF-32。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />2&nbsp;，按所表示的文字分类<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />语言&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;字符集&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;正式名称<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />英语、西欧语&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASCII，ISO-8859-1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBCS 多字节<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />简体中文&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GB2312&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;MBCS 多字节<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />繁体中文&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BIG5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBCS 多字节<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />简繁中文&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GBK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MBCS 多字节<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />中文、日文及朝鲜语&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GB18030&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MBCS 多字节<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />各国语言&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNICODE，UCS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DBCS 宽字节</p>
<p><strong>编码<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" /></strong>UTF-8：采用变长字节 (1 ASCII, 2 希腊字母, 3 汉字, 4 平面符号) 表示，网络传输, 即使错了一个字节，不影响其他字节，而双字节只要一个错了，其他也错了，具体如下：<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />如果只有一个字节则其最高二进制位为0；如果是多字节，其第一个字节从最高位开始，连续的二进制位值为1的个数决定了其编码的字节数，其余各字节均以10开头。UTF-8最多可用到6个字节。 </p>
<p style="padding-bottom: 10px; line-height: 18px; margin: 0px; padding-left: 0px; padding-right: 0px; font-size: 13px; padding-top: 0px">UTF-16：采用2字节，Unicode中不同部分的字符都同样基于现有的标准。这是为了便于转换。从 0&#215;0000到0&#215;007F是ASCII字符，从0&#215;0080到0&#215;00FF是ISO-8859-1对ASCII的扩展。希腊字母表使用从0&#215;0370到 0&#215;03FF 的代码，斯拉夫语使用从0&#215;0400到0&#215;04FF的代码，美国使用从0&#215;0530到0&#215;058F的代码，希伯来语使用从0&#215;0590到0&#215;05FF的代 码。中国、日本和韩国的象形文字（总称为CJK）占用了从0&#215;3000到0&#215;9FFF的代码；由于0&#215;00在c语言及操作系统文件名等中有特殊意义，故很 多情况下需要UTF-8编码保存文本，去掉这个0&#215;00。举例如下：<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />UTF-16: 0&#215;0080&nbsp; = 0000 0000 1000 0000<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />UTF-8:&nbsp;&nbsp; 0xC280 = 1100 0010 1000 0000<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />UTF-32：采用4字节。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />优缺点<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />UTF-8、UTF-16和UTF-32都可以表示有效编码空间 (U+000000-U+10FFFF) 内的所有Unicode字符。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />使用UTF-8编码时ASCII字符只占1个字节，存储效率比较高，适用于拉丁字符较多的场合以节省空间。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />对于大多数非拉丁字符（如中文和日文）来说，UTF-16所需存储空间最小，每个字符只占2个字节。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />Windows NT内核是Unicode（UTF-16），采用UTF-16编码在调用系统API时无需转换，处理速度也比较快。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />采用UTF-16和UTF-32会有Big Endian和Little Endian之分，而UTF-8则没有字节顺序问题，所以UTF-8适合传输和通信。<br style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px" />UTF-32采用4字节编码，一方面处理速度比较快，但另一方面也浪费了大量空间，影响传输速度，因而很少使用。</p>

<p>&nbsp;</p>
<p>二 转载 <br /></p>
<p>python与字符编码：</p>
<p><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">ASCII 是一种字符集,包括大小写的英文字母、数字、控制字符等，它用一个字节表示，范围是 0-127。<br /><br />Unicode分为UTF-8和UTF-16。UTF-8变长度的，最多 6 个字节，小于 127 的字符用一个字节表示，与 ASCII 字符集的结果一样，ASCII 编码下的英语文本不需要修改就可以当作 UTF-8 编码进行处理。<br /><br />Python 从 2.2 开始支持 Unicode ，<span style="color: #0000ff">函数 decode( char_set )可以实现 其它编码到 Unicode 的转换</span>，<span style="color: #0000ff">函数 encode( char_set )实现 Unicode 到其它编码方式的转换</span>。<br /><br />比如 ("你好").decode( "GB2312") 将得到 u'\u4f60\u597d'，即 "你"和&#8220;好"的 Unicode 码分别是 0x4f60 和 0x597d，再用 (u'\u4f60\u597d').encode("UTF-8") 将得到 '\xe4\xbd\xa0\xe5\xa5\xbd'，它是&nbsp; &#8220;你好&#8221;的UTF-8编码结果。<br /><br /><br />python中使用 unicode的关键：<span style="color: #0000ff;"><br /></span><span style="color: #0000ff;">unicode是一个类，函数unicode(str,"utf8")从utf8编码（当然也可以是别的编码）的字符串str生成 unicode类的对象</span></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma; color: #0000ff;">，<span style="color: #0000ff;">函数unc.encode("utf8")将unicode类的对象unc转换为（编码为）utf8编码（当然也可以是别的编码）的字符串</span></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma; color: #0000ff;">。</span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma; color: #3366ff;"><br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">于是，编写unicode相关程序，需要做的事情是：<br /><br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma; color: #0000ff;">* 获取数据（字符串）时，用unicode(str, "utf8")生成unicode对象<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma; color: #0000ff;">* 在程序中仅使用unicode对象，对程序中出现的字符串常量都以u"字符串"的形式书写<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma; color: #0000ff;">* 输出时，可将unicode对象转换为任意编码输出，使用str.encode("some_encoding")</span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;"><br /><br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; unicode("你好", "utf8")<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">u'\u4f60\u597d'<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; x = _<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; type(x)<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&lt;type 'unicode'&gt;<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; type("你好")<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&lt;type 'str'&gt;<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; x.encode("utf8")<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">'\xe4\xbd\xa0\xe5\xa5\xbd'<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; x.encode("gbk")<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">'\xc4\xe3\xba\xc3'<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; x.encode("gb2312")<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">'\xc4\xe3\xba\xc3'<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; print x<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">你好<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; print x.encode("utf8")<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">你好<br /></span><span style="line-height: 18px; font-family: Arial,sans-serif,Helvetica,Tahoma;">&gt;&gt;&gt; print x.encode("gbk")<br /></span></p><p><span style="line-height: 18px; font-family: Arial, sans-serif, Helvetica, Tahoma">???</span></p>
<p>&nbsp;</p>
<p><span style="font-family: Simsun">python里面基本上要考虑三种编码格式：<br />1 源文件编码<br />在文件头部使用coding声明。告诉python解释器该代码文件所使用的字符集。<br />＃/usr/bin/python<br />#coding: utf8<br /><br />2 内部编码<br />代码文件中的字符串，经过decode以后，被转换为统一的unicode格式的内部数据，类似于u'*'。unicode数据可以使用encode函数，再自由转换为其他格式的数据，相当于一个统一的平台。<br /><br />直接输入unicode数据<br />&gt;&gt;&gt; u'你好'<br />u'\u4f60\u597d'<br /><br />将unicode数据转换为gb2312格式<br />&gt;&gt;&gt; u'你好'.encode('gb2312')<br />'\xc4\xe3\xba\xc3'<br /><br />将输入的gb2312格式的数据解码为unicode<br />&gt;&gt;&gt; '你好'.decode('gb2312')<br />u'\u4f60\u597d'<br />输入数据的格式取决于所用shell终端的编码设置，本例中为zh_CN<br />[root@chenzheng python]# echo $LANG<br />zh_CN<br /><br />解码同时转换为utf8<br />&gt;&gt;&gt; '你好'.decode('gb2312').encode('utf8')<br />'\xe4\xbd\xa0\xe5\xa5\xbd'<br /><br />3 外部输入的编码<br />其实这个和在python交互shell中输入的字符串，所遇到的情况基本一样。但程序中常常用到从网络，文件读取的数据，故此单独列出，需要特别注意其编码格式是否于系统要求相符。<br /><br />下面是baidu中文本周金曲榜的链接，返回一个xml文件，编码格式为gb2312<br />http://box.zhangmen.baidu.com/x?op=4&amp;listid=1<br /><br />由于xml.etree.EelementTree.parse()不识别gb2312编码，在解析的时候，需要将其转换utf8格式才可以，可以使用下面的函数<br />def read_page(url):<br />"""读取gb2312编码的xml文件，转换为utf8格式"""<br />import urllib<br />udata = urllib.urlopen(url).read().decode('gb2312')<br />u8data = udata.encode('utf8')<br />return u8data.replace('gb2312', 'utf-8') #简单替换xml文件第一行的encoding属性值<br /><br />另外，可以使用一个小函数来判断数据的编码格式：<br />def encoding(s):<br />cl = ['utf8', 'gb2312']<br />for a in cl:<br />try:<br />s.decode(a)<br />return a<br />except UnicodeEncodeError:<br />pass<br />return 'unknown'&nbsp;</span></p>
<p>&nbsp;</p><p>完！ <br /></p>
