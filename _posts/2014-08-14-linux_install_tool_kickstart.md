---
layout: post
title: "Kickstart文件中的主要项目及参数介绍"
categories: linux
tags: [kickstart, linux]
date: 2014-08-14 09:09:09
---

<div id="cnblogs_post_body"><p><span size="3" style="font-size: small;">&nbsp;系统引导后，会显示boot：命令提示符；如上，界面上会有各种模式操作提示；<br>&nbsp; 注：用户交互的文本安装方式中不能进行LVM的自定义配置，只能查看、接受默认设置；</span></p>
<p><span style="font-size: 16px;"><br><span style="color: #339966;"><strong>&nbsp; 在boot：命令行里有用的几个项：</strong></span><br>&nbsp; <strong><span style="color: #339966;">lowres</span></strong><br>&nbsp;&nbsp;&nbsp; ：强制GUI安装时分辨率调低为640*480<br>&nbsp; <strong><span style="color: #339966;">noipv6</span></strong><br>&nbsp;&nbsp;&nbsp;&nbsp; ：安装过程不支持ipv6网络<br>&nbsp; <strong><span style="color: #339966;">noprobe</span></strong><br>&nbsp;&nbsp;&nbsp; ：不去自动检测硬件，而是提示用户；<br>&nbsp; <strong><span style="color: #339966;">dd=</span></strong><br>&nbsp;&nbsp;&nbsp; ：通过网络加载设备驱动<br>&nbsp; <strong><span style="color: #339966;">ks=</span></strong><br>&nbsp;&nbsp;&nbsp;&nbsp; ：指定kickstart文件的放置位置；<br>另外还有<strong>ip、netmask、gateway、dns、vnc</strong>等选项；<br><br>&nbsp;&nbsp; 用ks选项被指定时kickstart文件位置时，Anaconda进入Kickstart安装模式；<br><strong><span style="color: #339966;">安装时获取kickstart文件的方式：</span></strong><br><br><strong><span style="color: #339966;">（1） boot：linux ks</span></strong></span></p>
<p><span style="font-size: 16px;">&nbsp;&nbsp;&nbsp; ks命令单独使用时，系统会尝试通过dhcp服务器配置网卡，并且从DHCP会话中获取kickstart配置文件的位置；<br>&nbsp;&nbsp;&nbsp; 在dhcp服务器dhcp配置文件中有kickstart文件位置说明，next-server关键字指向共享文件的NFS主机，用filename关键字指向主机上的文件路径；如果没有filename关键字，则尝试在next-server关键字指向主机的/kickstart文件夹中找kickstart文件；<br>&nbsp;</span><strong><span style="font-size: 16px;">&nbsp;&nbsp;</span></strong><span style="font-size: 16px;"> 下面是dhcp.conf文件中kickstart配置字段示例：</span></p>
<p><span style="font-size: 16px;"><span>#&nbsp;The&nbsp;following&nbsp;lines&nbsp;are&nbsp;examples&nbsp;of&nbsp;kickstart&nbsp;directives.</span>&nbsp;</span><span style="font-size: 16px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;<span>"/data/ks/ks.cfg"</span>;&nbsp;</span><span style="font-size: 16px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next-server&nbsp;192.168.1.10;&nbsp;</span><span style="color: #339966;"><span style="font-size: 16px;"># 注：上面部分需要写在subnet子段中；</span></span>&nbsp;</p>
<p><strong><span style="color: #339966;"><span style="font-size: 16px;">（2） boot：linux ks=url</span></span></strong><span style="font-size: 16px;"><br>&nbsp; &nbsp;&nbsp; 基于网络的文件服务器（网络服务器），获取配置文件，支持HTTP、FTP、NFS方式获取文件；例：<br>&nbsp;&nbsp;&nbsp; ks=ftp://192.168.0.254/pub/kistart/ks.cfg<br>&nbsp;&nbsp;&nbsp; ks=http:// 192.168.0.254/pub/kistart/ks.cfg<br>&nbsp;&nbsp;&nbsp; ks=nfs:ip_addr:/path/to/ks.cfg<br><br><strong><span style="color: #339966;">（3） boot：linux ks=hd:device/path/to/your/kickstart_file</span></strong><br>&nbsp;&nbsp; &nbsp; 基于本地的安装方式，需要依次指定设备名，路径，文件名等；例如：&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp; 文件在光盘中：ks=cdrom:/ks.cfg<br>&nbsp;&nbsp; 文件在软盘中：&nbsp;&nbsp;&nbsp; ks=floppy:/filedirectory/ks.cfg<br>&nbsp;&nbsp; 文件在硬盘中：ks=hd:/sdb1/myfile/ks.cfg<br>&nbsp;&nbsp; 文件也可被打包进initrd根文件系统中：ks=file:/ks.cfg<br><br><span style="color: #339966;"><strong>kickstart文件结构介绍：</strong></span><br>&nbsp; 1.&nbsp;<span style="color: #339966;"> 命令部分</span>：配置系统的属性及安装中的各种必要设置信息<br>&nbsp; 2.&nbsp;<span style="color: #339966;"> %packages部分</span>：设定需要安装的软件包及包组，Anaconda会自动解决依赖关系<br>&nbsp; 3.&nbsp;<span style="color: #339966;"> 脚本部分：</span>用于定制系统，分为%pre部分在安装前运行，%post在安装后运行<br>&nbsp; &nbsp; %pre 部分脚本作为一个bash shell脚本执行，在Kickstart文件解析后执行；<br>&nbsp; &nbsp; %post 解析器默认为bash，可以自定义，缺省为chroot状态，也可指定非chroot状态；<br></span></p>
<p><span style="color: #ff0000;"><span style="font-size: 18px;"><span><strong>五.&nbsp; Kickstart文件中的主要项目及参数介绍：</strong></span></span></span></p>
<p><span style="font-size: 16px;"><br>&nbsp;&nbsp;&nbsp; 每个项目都由关键字来识别；关键字可跟一个或多个参数；如果某选项后面跟随了一个等号（=），它后面就必须指定一个值。<br><br><strong><span style="color: #339966;">install &nbsp; (可选)</span></strong><br>&nbsp;&nbsp;&nbsp; 明确指定系统次次进行的是全新安装系统；是默认项；<br><br><strong><span style="color: #339966;">cdrom&nbsp; （可选）</span></strong><br>&nbsp;&nbsp;&nbsp; 以本地CD-ROM为源安装系统；<br><br><strong><span style="color: #339966;">harddrive&nbsp; (可选)</span></strong><br>&nbsp;&nbsp;&nbsp; 以硬盘分区中包含的镜像为源（安装树）安装新系统；当以该种方式安装系统时，即使指定clearpart --all项，源所在分区也不会被重新抹去；<br>&nbsp;&nbsp;&nbsp; --partition=&nbsp;&nbsp;&nbsp; 指定分区<br>&nbsp;&nbsp;&nbsp; --dir=&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 指定包含镜像的目录<br>&nbsp;&nbsp;&nbsp; 例：<br>&nbsp;&nbsp;&nbsp; harddrive&nbsp; --partition=/dev/sdb2&nbsp; --dir=/data/iso<br></span></p></div>
